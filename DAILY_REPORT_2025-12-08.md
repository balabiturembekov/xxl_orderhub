# üìä –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ

**–î–∞—Ç–∞:** 8 –¥–µ–∫–∞–±—Ä—è 2025  
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** QA Engineer & Developer  
**–ü—Ä–æ–µ–∫—Ç:** XXL OrderHub

---

## üéØ –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ù–∞–π–¥–µ–Ω–æ –±–∞–≥–æ–≤:** 8
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –±–∞–≥–æ–≤:** 8
- **–°–æ–∑–¥–∞–Ω–æ –∫–æ–º–º–∏—Ç–æ–≤:** 6
- **–ò–∑–º–µ–Ω–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 8
- **–î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~189
- **–£–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~49

---

## üêõ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏ (–†–∞—É–Ω–¥ 7)

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –±–∞–≥–∞)

#### BUG-49: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª–∏–Ω—ã search_query - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è DoS –∞—Ç–∞–∫–∞

**–§–∞–π–ª—ã:** `orders/views/order_views.py`, `orders/views/payment_views.py`, `orders/views/shipment_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π search_query (–¥–æ 10,000+ —Å–∏–º–≤–æ–ª–æ–≤)
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –º–µ–¥–ª–µ–Ω–Ω—ã–º SQL –∑–∞–ø—Ä–æ—Å–∞–º (LIKE —Å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏)
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è DoS –∞—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É –ë–î

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –º–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤ (`ViewConstants.SEARCH_MAX_LENGTH`)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 2 —Å–∏–º–≤–æ–ª–∞ (`ViewConstants.SEARCH_MIN_LENGTH`)
- –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `OrderListView`, `InvoiceListView`, `ShipmentListView`

**–ö–æ–¥:**

```python
from ..constants import ViewConstants

search_query = self.request.GET.get('search', '').strip()
if search_query:
    if len(search_query) > ViewConstants.SEARCH_MAX_LENGTH:
        search_query = search_query[:ViewConstants.SEARCH_MAX_LENGTH]

    if len(search_query) >= ViewConstants.SEARCH_MIN_LENGTH:
        queryset = queryset.filter(...)
```

---

#### BUG-50: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @csrf_exempt –≤ API views - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è CSRF —É—è–∑–≤–∏–º–æ—Å—Ç—å

**–§–∞–π–ª:** `orders/views/api_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –û—Ç–∫–ª—é—á–µ–Ω–∞ CSRF –∑–∞—â–∏—Ç–∞ –≤ `create_country_ajax` –∏ `create_factory_ajax`
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è CSRF –∞—Ç–∞–∫–∞: –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–≥ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å

**–†–µ—à–µ–Ω–∏–µ:**

- –£–±—Ä–∞–Ω `@csrf_exempt` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
- –î–æ–±–∞–≤–ª–µ–Ω—ã `@csrf_protect` –∏ `@ensure_csrf_cookie` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
- CSRF —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-CSRFToken` –≤ AJAX –∑–∞–ø—Ä–æ—Å–∞—Ö
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è CSRF –∑–∞—â–∏—Ç–∞ Django —Ç–µ–ø–µ—Ä—å –∞–∫—Ç–∏–≤–Ω–∞

**–ö–æ–¥:**

```python
from django.views.decorators.csrf import csrf_protect, ensure_csrf_cookie

@login_required
@require_http_methods(["POST"])
@csrf_protect
@ensure_csrf_cookie
def create_country_ajax(request):
    # CSRF –∑–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞
```

---

### üü† –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3 –±–∞–≥–∞)

#### BUG-51: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ limit –≤ search_factories

**–§–∞–π–ª:** `orders/views/api_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä `limit` –º–æ–≥ –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –∏–ª–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã `query`

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è `limit`: –¥–∏–∞–ø–∞–∑–æ–Ω –æ—Ç 1 –¥–æ `MAX_PAGE_SIZE` (100)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã `query` (–º–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ `query`: 2 —Å–∏–º–≤–æ–ª–∞

---

#### BUG-52: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª–∏–Ω—ã rejection_reason

**–§–∞–π–ª:** `orders/views/confirmation_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (10,000+ —Å–∏–º–≤–æ–ª–æ–≤)
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ë–î –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã: –º–∞–∫—Å–∏–º—É–º 2000 —Å–∏–º–≤–æ–ª–æ–≤
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `max_length` –≤ –º–æ–¥–µ–ª–∏ `OrderConfirmation`

---

#### BUG-53: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è year –∏ month –≤ EFacturaBasketListView

**–§–∞–π–ª:** `orders/views/efactura_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `year` (–Ω–∞–ø—Ä–∏–º–µ—Ä, -1000 –∏–ª–∏ 99999)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `month` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0 –∏–ª–∏ 99)
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ `year`: 2000-2100
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ `month`: 1-12

---

### üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3 –±–∞–≥–∞)

#### BUG-54: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π IntegrityError –≤ get_or_create_for_month

**–§–∞–π–ª:** `orders/models.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º –æ–±—â–∏–π `Exception`
- –ú–æ–≥–ª–∏ —Å–∫—Ä—ã–≤–∞—Ç—å—Å—è –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å IntegrityError
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è race condition –º–µ–∂–¥—É `get_or_create` –∏ `get`

**–†–µ—à–µ–Ω–∏–µ:**

- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `IntegrityError`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `select_for_update()` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è race condition
- –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –¥–∞–ª—å—à–µ

**–ö–æ–¥:**

```python
from django.db import IntegrityError

try:
    basket, created = cls.objects.get_or_create(...)
except IntegrityError:
    basket = cls.objects.select_for_update().get(month=month, year=year)
    created = False
except Exception as e:
    raise
```

---

#### BUG-55: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è factory_id –∏ country_id –≤ OrderListView

**–§–∞–π–ª:** `orders/views/order_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–µ—Ä–µ–¥–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∏–ª–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è: –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

---

#### BUG-56: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è country_id –≤ get_factories

**–§–∞–π–ª:** `orders/views/api_views.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `country_id`
- –û—à–∏–±–∫–∏ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –û–±—Ä–∞–±–æ—Ç–∫–∞ `ValueError` –∏ `TypeError`

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —á–µ–∫–±–æ–∫—Å–æ–≤ Factura Export –∏ E-Factura Turkey

**–§–∞–π–ª:** `templates/orders/order_detail.html`

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ú–æ–∂–Ω–æ –±—ã–ª–æ —Å–Ω—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π checkbox
- –ú–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å –æ–±–∞ —Ç–∏–ø–∞ —Ñ–∞–∫—Ç—É—Ä—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ù–µ—É–¥–æ–±–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:**

- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–æ —Å–Ω—è—Ç–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ checkbox
- –í–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–π –≤—ã–±–æ—Ä: –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–∏–ø —Ñ–∞–∫—Ç—É—Ä—ã
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å `alert()` —Å–æ–æ–±—â–µ–Ω–∏–µ–º

**–ö–æ–¥:**

```javascript
// –õ–æ–≥–∏–∫–∞: –Ω–µ–ª—å–∑—è —Å–Ω—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π checkbox
if (!currentFacturaExport && !currentEFacturaTurkey) {
  checkbox.checked = true;
  warning.style.display = "block";
  alert("–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–∏–ø —Ñ–∞–∫—Ç—É—Ä—ã!");
  return;
}

// –õ–æ–≥–∏–∫–∞: –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–∏–ø —Ñ–∞–∫—Ç—É—Ä—ã
if (currentFacturaExport && currentEFacturaTurkey) {
  if (checkbox.id === "facturaExport") {
    eFacturaTurkey.checked = false;
  } else {
    facturaExport.checked = false;
  }
}
```

---

## üìù –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã

1. **ac7fa69** - `BUG-49: –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã search_query –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è DoS –∞—Ç–∞–∫`

   - –í–∫–ª—é—á–∞–µ—Ç —Ç–∞–∫–∂–µ BUG-55 (–≤–∞–ª–∏–¥–∞—Ü–∏—è factory_id –∏ country_id)
   - –§–∞–π–ª—ã: `order_views.py`, `payment_views.py`, `shipment_views.py`

2. **6164cec** - `BUG-50: –ó–∞–º–µ–Ω–∞ @csrf_exempt –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é CSRF –∑–∞—â–∏—Ç—É`

   - –í–∫–ª—é—á–∞–µ—Ç —Ç–∞–∫–∂–µ BUG-51 –∏ BUG-56
   - –§–∞–π–ª: `api_views.py`

3. **aaf6511** - `BUG-52: –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã rejection_reason`

   - –í–∫–ª—é—á–∞–µ—Ç —Ç–∞–∫–∂–µ BUG-53 (–≤–∞–ª–∏–¥–∞—Ü–∏—è year –∏ month)
   - –§–∞–π–ª—ã: `confirmation_views.py`, `efactura_views.py`

4. **f592cb9** - `BUG-54: –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ IntegrityError –≤ get_or_create_for_month`

   - –§–∞–π–ª: `models.py`

5. **e6b1d69** - `docs: –î–æ–±–∞–≤–ª–µ–Ω –æ—Ç—á–µ—Ç BUGS_REPORT_7.md —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –±–∞–≥–∞–º–∏`

   - –§–∞–π–ª: `BUGS_REPORT_7.md`

6. **f9c9f20** - `fix: –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —á–µ–∫–±–æ–∫—Å–æ–≤ Factura Export –∏ E-Factura Turkey`
   - –§–∞–π–ª: `order_detail.html`

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

- `orders/views/order_views.py` - +35 —Å—Ç—Ä–æ–∫
- `orders/views/payment_views.py` - +20 —Å—Ç—Ä–æ–∫
- `orders/views/shipment_views.py` - +18 —Å—Ç—Ä–æ–∫
- `orders/views/api_views.py` - +42 —Å—Ç—Ä–æ–∫–∏
- `orders/views/confirmation_views.py` - +12 —Å—Ç—Ä–æ–∫
- `orders/views/efactura_views.py` - +9 —Å—Ç—Ä–æ–∫
- `orders/models.py` - +10 —Å—Ç—Ä–æ–∫
- `templates/orders/order_detail.html` - +69 —Å—Ç—Ä–æ–∫

### –¢–∏–ø—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 2 (CSRF –∑–∞—â–∏—Ç–∞, DoS –∑–∞—â–∏—Ç–∞)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** 6
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** 1
- **UX —É–ª—É—á—à–µ–Ω–∏—è:** 1

---

## üéØ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é CSRF –∑–∞—â–∏—Ç—É Django  
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DoS –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª–∏–Ω—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  
‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏  
‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:

‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (—Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è)  
‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ race conditions —á–µ—Ä–µ–∑ `select_for_update()`

### UX:

‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —á–µ–∫–±–æ–∫—Å–æ–≤  
‚úÖ –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–∞–≥–∞—Ö:

- `BUGS_REPORT_7.md` - —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö 8 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–∞–≥–æ–≤ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞ –∏ —Ä–µ—à–µ–Ω–∏—è–º–∏

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –í—Å–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
2. ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –≥—Ä—É–ø–ø–∞–º–∏
3. ‚è≥ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
4. ‚è≥ –ì–æ—Ç–æ–≤–æ –∫ push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

- **–ü–æ–∫—Ä—ã—Ç–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:** 100% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –£–ª—É—á—à–µ–Ω–∞ CSRF –∑–∞—â–∏—Ç–∞
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ó–∞—â–∏—Ç–∞ –æ—Ç DoS –∞—Ç–∞–∫
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

**–ò—Ç–æ–≥:** –í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –∫–æ–¥ —É–ª—É—á—à–µ–Ω, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.
